---           
layout: post
title: Python 2.6 and PyBluez
date: 2013-07-08 22:04:28 UTC
updated: 2013-07-08 22:04:28 UTC
comments: false
categories: 
---

My research on Python ended with Python 2.6 and PyBluez. If you haven't noticed, there are newer version of Python (currently on version 3.3) but the later versions are not compatible with PyBluez. My so-far googling skills got me to the conclusion that this is the better solution, albeit temporarily. Python does not have Bluetooth native library before version 3.0 (if I'm not mistaken) and while they have added them now, the documentations were not really thorough. PyBluez, on the contrary, is only supported for Python until version 2.6. Since I have to do some demonstration with Python and Bluetooth, this is the easier solution. I will get back to the Python native Bluetooth library later on.<br /><br />This post will help you to do 2 things, assuming you're on Windows:<br /><br />1. Installing Python 2.6 and PyBluez<br />2. Run a simple Bluetooth serial server script<br /><br />Installing Python 2.6 and PyBluez<br />1. Get them both here : <a href="http://www.python.org/ftp/python/2.6.6/python-2.6.6.msi">Python 2.6</a>&nbsp;<a href="https://pybluez.googlecode.com/files/PyBluez-0.18.win32-py2.6.exe">PyBluez</a><br />2. Run the Python installer first, followed by the PyBluez Installer<br /><br />Run the Bluetooth serial server<br />1. Copy the whole code below into a file named BluetoothServer.py<br />2. Save the file in the same folder where Python was installed previously<br />3. At this point, turn on your Bluetooth, set for an incomming connection (set a listening port) and pair with the other device (client)<br />4. Start the Windows command prompt. Navigate to the folder where Python was installed<br />5. Run the script : &gt;&gt;python BluetoothServer.py<br />6. Server is active and ready for an incoming connection : "Waiting for connection on RFCOMM Channel 1"<br /><br />The simple server is based on the PyBluez examples&nbsp;<a href="https://code.google.com/p/pybluez/source/browse/trunk/examples/simple/rfcomm-server.py">here</a>.<br /><br /><span style="font-family: Courier New, Courier, monospace;"># file: BluetoothServer.py</span><br /><span style="font-family: Courier New, Courier, monospace;"># desc: Simple Bluetooth Serial Server (Python 2.6 and PyBluez)</span><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">from bluetooth import *</span><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">server_sock=BluetoothSocket( RFCOMM )</span><br /><span style="font-family: Courier New, Courier, monospace;">server_sock.bind(("",PORT_ANY))</span><br /><span style="font-family: Courier New, Courier, monospace;">server_sock.listen(1)</span><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">port = server_sock.getsockname()[1]</span><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: 'Courier New', Courier, monospace;">#change UUID accordingly</span><br /><span style="font-family: Courier New, Courier, monospace;">uuid = "94f39d29-7d6d-437d-973b-fba39e49d4ee"&nbsp;</span><br /><br /><span style="font-family: 'Courier New', Courier, monospace;">#start the listening server</span><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">advertise_service( server_sock, "BluetoothServer",</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;service_id = uuid,</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;service_classes = [ uuid, SERIAL_PORT_CLASS ],</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;profiles = [ SERIAL_PORT_PROFILE ],&nbsp;</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="font-family: Courier New, Courier, monospace;">print "Waiting for connection on RFCOMM channel %d" % port</span><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: 'Courier New', Courier, monospace;">#accepting connection</span><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">client_sock, client_info = server_sock.accept()</span><br /><span style="font-family: Courier New, Courier, monospace;">print "Accepted connection from ", client_info</span><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: 'Courier New', Courier, monospace;">#catch data and display. <br />#wait for the client to cut off the connection</span><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">try:</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; while True:</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; data = client_sock.recv(1024)</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; if len(data) == 0: break</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; print "received [%s]" % data</span><br /><span style="font-family: Courier New, Courier, monospace;">except IOError:</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; pass</span><br /><br /><span style="font-family: Courier New, Courier, monospace;">print "client disconnected"</span><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: 'Courier New', Courier, monospace;">#close sockets&nbsp;</span><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">client_sock.close()</span><br /><span style="font-family: Courier New, Courier, monospace;">server_sock.close()</span><br /><span style="font-family: Courier New, Courier, monospace;">print "Server is off"</span><br /><br />The Android App (client) for sending in data is discussed separately on another post. The next step is to have this simple server ran on the Raspberry Pi and adding in some output manipulations using the Pi's GPIO pins.<br /><br />Update: Here is a good read on the same topic. <a href="https://www.dropbox.com/s/6hvbab04j854l58/Python%20and%20Bluetooth.pdf">Link</a>