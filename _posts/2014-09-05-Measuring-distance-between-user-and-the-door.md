---           
layout: post
title: Measuring distance between user and the door
date: 2014-09-05 11:21:48 UTC
updated: 2014-09-05 11:21:48 UTC
comments: false
categories: 
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-RXNlxYb9yvM/Ule-HVZ9T_I/AAAAAAAAAys/mYbwrHzdcm4/s1600/Untitled+drawing+(4).jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="426" src="http://2.bp.blogspot.com/-RXNlxYb9yvM/Ule-HVZ9T_I/AAAAAAAAAys/mYbwrHzdcm4/s640/Untitled+drawing+(4).jpg" width="640" /></a></div><br /><br />We have no way of measuring distance directly between the user (the phone) and the door. However, we can safely approximate the distance by querying the "strength" of the received signal of the Bluetooth communication. The term is called Bluetooth Received Signal Strength Indication (RSSI). RSSI is the relative received signal strength in arbitrary units.<br /><br />In short, the closer the distance, the bigger the strength of the received signal, the bigger the RSSI numbers.<br /><br />In our case, we have two ways to implement this:<br /><ol><li>The Rpi does the query for signal strength and responses (to command the microcontroller to unlock the door) only when the signal strength is within the safe operating range.</li><li>The App (instead of the Rpi), which initiates the connection, sends the signal ("within range" or "not within range") along with key based on the received signal strength (Android is able to provide this automatically on each Bluetooth connection or we can use one of the public methods to query manually) of the Rpi.</li></ol><div>However, both methods relies heavily on the actual Bluetooth devices that we are using. We need to do some test on our own to approximate better (sadly we only have one Bluetooth dongle that works with Rpi at this moment). <br /><br />This is one example I've got from the net which should give us some approximations:<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<b> RSSI &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Position</b><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 38 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Phone touching Bluetooth dongle<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 25 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Phone an inch away</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Phone about 6 inch away</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; From 2 feet to opposite side of room</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;In next room (with a wall between)</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 walls away<br /><span style="font-family: Arial, Helvetica, sans-serif;"><br style="background-color: #fcfcfc; color: #333333; font-size: 13px; line-height: 19.234375px;" /></span></div>source:<br /><a href="http://www.raspberrypi.org/phpBB3/viewtopic.php?t=47466&amp;p=372150">Link1</a><br /><a href="http://developer.android.com/reference/android/bluetooth/BluetoothDevice.html#EXTRA_RSSI">Link2</a><br /><a href="http://developer.android.com/reference/android/bluetooth/BluetoothGatt.html#readRemoteRssi()">Link3</a><br /><br /><br /><br /><br /><div><br /></div>